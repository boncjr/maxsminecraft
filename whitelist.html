<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>BetterSchoolSMP Waitlist</title>

<style>
html, body {
  height: 100%;
  margin: 0;
  background: #0b1020;
  font-family: monospace;
  color: #fff;
  display: flex;
  justify-content: center;
  align-items: center;
}

.card {
  width: 520px;
  padding: 30px;
  border-radius: 16px;
  background: rgba(15, 20, 45, 0.95);
  animation: glow 6s linear infinite;
}

@keyframes glow {
  0% { box-shadow: 0 0 20px #6cf, 0 0 40px #b6f, 0 0 60px #f6c; }
  50% { box-shadow: 0 0 25px #f6c, 0 0 45px #6cf, 0 0 65px #b6f; }
  100% { box-shadow: 0 0 20px #6cf, 0 0 40px #b6f, 0 0 60px #f6c; }
}

h1 {
  margin-top: 0;
  text-align: center;
  color: #9fd7ff;
}

input, button {
  width: 100%;
  padding: 10px;
  margin-top: 10px;
  border-radius: 8px;
  border: none;
  font-family: monospace;
}

input {
  background: #101530;
  color: #fff;
}

button {
  background: #6cf;
  color: #000;
  cursor: pointer;
  font-weight: bold;
}

button:disabled {
  background: #555;
  cursor: not-allowed;
}

ul {
  margin-top: 20px;
  padding-left: 20px;
}

.notice {
  margin-top: 10px;
  font-size: 0.85em;
  color: #bbb;
  text-align: center;
}
</style>
</head>

<body>
<div class="card">
  <h1>ðŸ“‹ Server Waitlist</h1>

  <input id="nameInput" placeholder="Minecraft Username">
  <button id="submitBtn">Join Waitlist</button>

  <div class="notice">
    Each IP may submit <b>twice</b>.
  </div>

  <ul id="list"></ul>
</div>

<script>
const listEl = document.getElementById("list");
const btn = document.getElementById("submitBtn");
const input = document.getElementById("nameInput");

let userIP = null;

fetch("https://api.ipify.org?format=json")
  .then(r => r.json())
  .then(d => userIP = d.ip);

function loadList() {
  listEl.innerHTML = "";
  const entries = JSON.parse(localStorage.getItem("waitlist") || "[]");
  entries.forEach(e => {
    const li = document.createElement("li");
    li.textContent = e.name;
    listEl.appendChild(li);
  });
}

btn.onclick = () => {
  if (!userIP) return alert("IP not loaded yet");
  if (!input.value.trim()) return;

  const entries = JSON.parse(localStorage.getItem("waitlist") || "[]");
  const counts = JSON.parse(localStorage.getItem("ipCounts") || "{}");

  counts[userIP] = counts[userIP] || 0;

  if (counts[userIP] >= 2) {
    alert("IP limit reached (2 submissions max)");
    return;
  }

  entries.push({ name: input.value.trim(), ip: userIP });
  counts[userIP]++;

  localStorage.setItem("waitlist", JSON.stringify(entries));
  localStorage.setItem("ipCounts", JSON.stringify(counts));

  input.value = "";
  loadList();
};

loadList();
</script>
</body>
</html>
